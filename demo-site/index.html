<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>NEO Demo - via Proxy</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; max-width: 900px; margin: 40px auto; padding: 0 16px; }
    header { display: flex; align-items: center; gap: 8px; }
    input, button { padding: 8px 12px; }
    pre { background: #111; color: #0f0; padding: 12px; overflow: auto; border-radius: 8px; }
    .row { display: flex; gap: 8px; flex-wrap: wrap; margin: 8px 0; }
    label { font-weight: 600; }
  </style>
</head>
<body>
  <header>
    <h1>NEO Demo (NASA NeoWS via Proxy)</h1>
  </header>

  <section>
    <label>Proxy Base URL</label>
    <div class="row">
      <input id="apiBase" style="min-width:420px" placeholder="https://seu-servico.onrender.com" />
      <button onclick="ping()">Test /health</button>
    </div>
    <pre id="out">Saída aparecerá aqui…</pre>
  </section>

  <section>
    <h2>Feed</h2>
    <div class="row">
      <input id="start" placeholder="YYYY-MM-DD">
      <input id="end" placeholder="YYYY-MM-DD (opcional)">
      <button onclick="doFeed()">Buscar</button>
    </div>
  </section>

  <section>
    <h2>Detalhe por NEO ID</h2>
    <div class="row">
      <input id="neoId" placeholder="Ex.: 3726710">
      <button onclick="doDetail()">Buscar</button>
    </div>
  </section>

  <section>
    <h2>Browse</h2>
    <div class="row">
      <input id="page" type="number" value="0">
      <input id="size" type="number" value="10">
      <button onclick="doBrowse()">Buscar</button>
    </div>
  </section>

  <script>
    function out(txt){ document.getElementById('out').textContent = typeof txt === 'string' ? txt : JSON.stringify(txt, null, 2); }
    function base(){ return document.getElementById('apiBase').value.trim(); }

    async function ping(){
      try{
        const r = await fetch(base() + '/health');
        out(await r.json());
      }catch(e){ out('Erro: ' + e); }
    }

    async function doFeed(){
      const s = document.getElementById('start').value.trim();
      const e = document.getElementById('end').value.trim();
      let url = new URL(base() + '/neo/feed');
      url.searchParams.set('start_date', s);
      if(e) url.searchParams.set('end_date', e);
      try{
        const r = await fetch(url);
        out(await r.json());
      }catch(err){ out('Erro: ' + err); }
    }

    async function doDetail(){
      const id = document.getElementById('neoId').value.trim();
      try{
        const r = await fetch(base() + '/neo/' + id);
        out(await r.json());
      }catch(err){ out('Erro: ' + err); }
    }

    async function doBrowse(){
      const p = document.getElementById('page').value.trim() || '0';
      const s = document.getElementById('size').value.trim() || '10';
      let url = new URL(base() + '/neo/browse');
      url.searchParams.set('page', p);
      url.searchParams.set('size', s);
      try{
        const r = await fetch(url);
        out(await r.json());
      }catch(err){ out('Erro: ' + err); }
    }
  </script>
</body>
</html>
